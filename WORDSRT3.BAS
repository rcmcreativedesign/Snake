DECLARE FUNCTION CHECKGUESS! (WORD AS STRING, ANSWER AS STRING)
DECLARE SUB BUBBLESORT (WORD() AS STRING)
DECLARE FUNCTION CHECKANSWER! (WORD AS STRING, ANSWER AS STRING)
DECLARE SUB PRINTWORD (LETTERS() AS STRING)
CLS

DIM WORDS(5) AS STRING
WORDS(1) = "MATH"
WORDS(2) = "JESUS"
WORDS(3) = "GARLIC"
WORDS(4) = "SPINACH"
WORDS(5) = "GEOGRAPHY"

DIM LETTERS(UBOUND(WORDS)) AS STRING

DIM USERGUESS AS STRING
DIM USERTRY AS INTEGER: USERTRY = 1

'Loop through each word
FOR L = 1 TO UBOUND(WORDS)
    REDIM LETTERS(LEN(WORDS(L)))
    FOR M = 1 TO LEN(WORDS(L))
        LETTERS(M) = MID$(WORDS(L), M, 1)
    NEXT

    CALL BUBBLESORT(LETTERS())

    CLS
    LOCATE 1, 1: PRINT "LEVEL "; L
    CALL PRINTWORD(LETTERS())
    LOCATE 24, 1: INPUT ; "ENTER YOUR GUESS: ", USERGUESS
    IF UCASE$(USERGUESS) = "QUIT" THEN
        GOTO QUIT
    END IF

    DO WHILE CHECKGUESS(WORDS(L), USERGUESS) = 0 AND USERTRY < 5
        LOCATE 2 + USERTRY, 1: PRINT "THAT GUESS IS WRONG. "; 5 - USERTRY; " GUESS(ES) LEFT"
        USERTRY = USERTRY + 1
        LOCATE 24, 1: INPUT ; "ENTER YOUR GUESS: ", USERGUESS
        IF UCASE$(USERGUESS) = "QUIT" THEN
            GOTO QUIT
        END IF
    LOOP
   
    IF CHECKGUESS(WORDS(L), USERGUESS) = 0 THEN
        LOCATE 3 + USERTRY: PRINT "THE WORD IS: "; WORDS(L)
        GOTO QUIT
    END IF
    USERTRY = 1

NEXT

QUIT:

SUB BUBBLESORT (WORD() AS STRING)
    DIM TEMP AS STRING
    FOR X = 1 TO UBOUND(WORD)
        FOR Y = 1 TO UBOUND(WORD)
            IF WORD(Y) > WORD(X) THEN
                LET TEMP = WORD(X)
                LET WORD(X) = WORD(Y)
                LET WORD(Y) = TEMP
            END IF
        NEXT
    NEXT
END SUB

FUNCTION CHECKGUESS (WORD AS STRING, ANSWER AS STRING)
    IF ANSWER = WORD THEN
        CHECKGUESS = 1
    ELSE
        CHECKGUESS = 0
    END IF
END FUNCTION

SUB PRINTWORD (LETTERS() AS STRING)
    FOR X = 1 TO UBOUND(LETTERS)
        PRINT LETTERS(X);
    NEXT
END SUB

